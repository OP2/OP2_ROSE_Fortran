
\section{CERT-MSC30-C: No Rand}
\label{NoRand::overview}
``CERT Secure Coding MSC30-C'' states
\begin{quote}
The C Standard function {\tt rand} (available in {\tt stdlib.h}) does not have good random number properties. The numbers generated by {\tt rand} have a comparatively short cycle, and the numbers may be predictable. To achieve the best random numbers possible, an implementation-specific function needs to be used.
\end{quote}

\subsection{Parameter Requirements}
This checker takes no parameters and inputs source file.

\subsection{Implementation}
This pattern is checked using a simple AST traversal that visits all function reference expressions. If a functino reference expression node corresponds to the {\tt rand()} function, then a violation is flagged.

\subsection{Non-Compliant Code Example}
The following code calls {\tt rand()}.

 \code{ 

\noindent
\ttfamily
\hlstd{}\hlline{\ \ \ \ 1\ }\hlstd{}\hldir{\#include\ $<$stdlib.h$>$\\
}\hlline{\ \ \ \ 2\ }\hldir{}\hlstd{\\
}\hlline{\ \ \ \ 3\ }\hlstd{}\hltyp{int\ }\hlstd{main}\hlsym{()\\
}\hlline{\ \ \ \ 4\ }\hlsym{\{\\
}\hlline{\ \ \ \ 5\ }\hlsym{\hlstd{\ \ }}\hlstd{}\hltyp{int\ }\hlstd{r\ =\ rand}\hlsym{()}\hlstd{;\hlstd{\ \ }}\hlcom{/*\ generate\ a\ random\ integer\ */}\hlstd{\\
}\hlline{\ \ \ \ 6\ }\hlstd{\\
}\hlline{\ \ \ \ 7\ }\hlstd{\hlstd{\ \ }}\hlkey{return\ }\hlstd{}\hlnum{0}\hlstd{;\\
}\hlline{\ \ \ \ 8\ }\hlstd{}\hlsym{\}}\hlstd{}\\
\mbox{}\\
\normalfont








}


\subsection{Compliant Solution}
The compliant solution is to use a implementation-specific random number generator.

 \code{ 

\noindent
\ttfamily
\hlstd{}\hlline{\ \ \ \ 1\ }\hlstd{}\hltyp{int\ }\hlstd{main}\hlsym{()\\
}\hlline{\ \ \ \ 2\ }\hlsym{\{\\
}\hlline{\ \ \ \ 3\ }\hlsym{\hlstd{\ \ }}\hlstd{}\hltyp{int\ }\hlstd{r\ =\ my\textunderscore rand}\hlsym{()}\hlstd{;\hlstd{\ \ }}\hlcom{/*\ generate\ a\ random\ integer\ */}\hlstd{\\
}\hlline{\ \ \ \ 4\ }\hlstd{\\
}\hlline{\ \ \ \ 5\ }\hlstd{\hlstd{\ \ }}\hlkey{return\ }\hlstd{}\hlnum{0}\hlstd{;\\
}\hlline{\ \ \ \ 6\ }\hlstd{}\hlsym{\}}\hlstd{}\\
\mbox{}\\
\normalfont






}


\subsection{Mitigation Strategies}
\subsubsection{Static Analysis} 

Compliance with this rule can be checked using structural static analysis checkers using the following algorithm:

\begin{enumerate}
\item Perform a simple AST traversal visiting all function reference expression nodes.
\item For each node visited, if the function reference expression corresponds to {\tt rand()} then flag violation.
\item Report any violations. 
\end{enumerate}

\subsection{References}
\htmladdnormallink{Secure Coding : MSC30-C. Do not use the rand function}{https://www.securecoding.cert.org/confluence/display/seccode/POS33-C.+Do+not+use+vfork\%28\%29}
